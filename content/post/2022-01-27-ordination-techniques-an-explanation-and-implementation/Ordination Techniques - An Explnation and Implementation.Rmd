---
title: "Ordination Techniques - An Explanation and Implementation"
author: "John Oliver"
date: "1/27/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, include = F)
```

```{r, warning = F}
library(ggplot2)
library(dplyr)
library(stats)
```

One common task within the data science world is to examine similarities and differences among observations within the data. Taking a step back from the computer, this problem presents itself in everyday life too. When I set my fantasy football lineup, I'm comparing a pool of players who produce multiple performance statistics. When I pack a lunch for the day, I'm looking into all the different foods I have in my fridge, and what kind of nutrients they have to offer me.

In the case of fantasy football - it's neccesary for me to analyze these performance statistics, and distinguish which players I'd like to start, and which I'd like to sit. In the case of packing a lunch - if I'm aiming for a healthy and energizing lunch, I have to think about all the nutrients within each food to determine which foods will keep me going, and which foods will make me crash. 

In both such cases, I need to examine each individual observation (player or food), and their corresponding variables (performance statistics or nutrients). In a small scale, this is simple. Let's say for my lunch I'm looking for foods with a high amount of vitamin C. Well, I can simply display this on a number line or graph and get an answer.

```{r, include = T}
df <- data.frame(Food = c("Pineapple", "Orange", "Pizza", "Burger"),
                 vitaminC = c(500,700,90,110))

df %>% 
  ggplot(., aes(x = Food, y = vitaminC, color = Food)) +
  geom_point() 
```

This choice is easy. If I want a food with high amounts of vitamin C, I'm going to reach in my fridge and grab an orange or some pineapple. With one variable, this is easy to visualize and analyze. 

Even with two variables, the task is not that hard. Let's say I'm also dieting, and I want a food with low amounts of calories, while having high levels of vitamin C. We can visualize this in 2 dimensions, quite easily.

```{r, include = T}
df2 <- data.frame(Food = c("Pineapple", "Orange", "Pizza", "Burger"),
                 vitaminC = c(500,700,90,110),
                 calories = c(50, 75, 550, 670))

df2 %>% 
  ggplot(., aes(x = calories, y = vitaminC, color = Food)) +
  geom_point() 
```
Again, not that difficult. We clearly want to choose the orange or the pineapple again. 2-dimensions, not hard. But let's expand this to three dimensions. Definitely doable, but with large amounts of observations it becomes hazier. 4-dimensions? Forget it. Once we move past 3 dimensions, plotting is not possible. Humans haven't yet figured out how to convey data in 4 dimensions. Or they have, but it's extremely hard to interpret. 

So how do we move past 2 or 3 dimensions? What if, for my fantasy football team, I wanted to look into a players touchdowns, yards, catches, yards after catch, drops, and broken tackles. Or for my lunch, I wanted to look into vitamin C, calories, vitamin D, vitamin B, fat, cabrs, and protein. Now that we're past 2 variables (2 dimensions), we need other methods to analyze this data.

# Ordination 

The answer: ordination techniques. Ordination techniques allow us to visualize our _n_ starting variables in a desired amount of dimensions. In most cases, the desirable amount of dimensions is too. In other words, ordination allows us to view our _n_ starting variables in 2 dimensions. So rather than twisting your brain trying to create an _n_ dimensional plot, we can simply visualize as a scatter plot in 2 dimensions.

Each dot within this scatterplot will therefore refer to one observation from our data set. In my examples, this would mean that each dot would represent one football player, or one type of food. Observations that are closer to each other within the graph can be assumed to have similar levels of the examined _n_ variables. Converesely, observations that appear farther apart will have differing levels. Lets take a look at an example.

Let's go back to the food set and say that we're now interested in Vitamin C, calories, vitamin D, protein, and carbs. I'll go into depth later on about the types of ordination techniques but for now, let's just say I'm using a technique called Principle Component Analysis (PCA). Here's how the method of PCA takes our original 5 variables and plots it in 2 dimensions.

```{r}
df3 <- data.frame(Food = c("Pineapple", "Apple", "Orange", "Pizza",
                           "Burger"),
                 vitaminC = c(600, 600, 600, 115,107),
                 calories = c(80, 80, 75, 650, 635),
                 vitaminD = c(400, 450, 500, 13, 16),
                 protein = c(5, 4, 3, 50, 42),
                 carbs = c(2, 3, 4, 55, 50))

pca_df <- df3 %>% 
  select(-Food)

pca_fit <- princomp(scale(pca_df), cor = F)

new_df <- df3 %>% 
  mutate(pc1 = pca_fit$scores[,1],
         pc2 = pca_fit$scores[,2])

new_df %>% 
  ggplot(., aes(x = pc1, y = pc2, color = Food)) +
  geom_point() +
  geom_text(aes(label = Food, vjust = -.5)) +
  theme(legend.position = "none") +
  xlab("PC1") +
  ylab("PC2")
  
```
We would expect all healthier foods to contain somewhat similar levels of nutrients. We would probably also assume that they have differing levels of nutrients than unhealthy foods do. This is shown in the graph above! We can see some clear seperation here. Notice how on the greater side of the x-axis (PC1), we see the healthy foods - pineapple, apple, orange. As we decrease in value on the x-axis (PC1), we see the unhealthy foods - pizza, burger. Healthier foods are clustering near each other, while unhealthy foods are clustering near each other.

Ordination techniques are a great method of concluding similarities and differences between our observations, based on the variables they contain. In what would be a very daunting task of considering a plethora of nutrients, we can simply carry out an ordination technique and get a general consensus based on the visualizaiton.
