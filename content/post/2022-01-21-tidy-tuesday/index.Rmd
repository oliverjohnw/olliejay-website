---
title: "Tidy Tuesday - Cocoa Beans"
author: "John Oliver"
date: '2022-01-21'
slug: tidy-tuesday-01-21-22
categories: null
tags: null
---

```{r, echo = F, include = F, warning = F}
# load packages
library(tidytuesdayR)
library(rworldmap)
library(dplyr)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(RColorBrewer)
```


This week marks the first week I will be participating in Tidy Tuesday. Tidy Tuesday, for those unfamiliar, is a weekly project hosted at https://github.com/rfordatascience/tidytuesday. Each Monday, a new data set is posted, and users around the world are challenged to dive in and find interesting information. There is no structure to it. You are simply handed a data set and told to get after it.

The project leader will give descriptions of variables, so you're not totally in the dark. Participants are encouraged to share their findings on Github, or on Twitter with the hashtag #TidyTuesday. It's an awesome way to establish a community of people who are trying to learn.

This weeks data set had everything to do with cocoa beans and chocolate bars. Specifically, this data looked into how users rated specific chocolate bars. Within the provided data set, each observation referred to one chocolate candy bar manufacturer. Recorded among each manufacturer were things such as location of manufacturing plant, average rating of the chocolate bar that they produced, and source location of where they were receiving their cocoa beans from. With no sense of direction and a loaded dataset, I was ready to dive into my first #TidyTuesday challenge.

# Producers

The process of constructing the world's perfect chocolate bar starts with cocoa beans. The manufactures turn these beans into the end product - a delicious candy bar. It's easy to praise the manufacturer when looking at the end product. In my eyes, however, the real heroes are the people growing the cocoa beans. Without them, this process would never occur!

That being said, I decided to look into where exactly these cocoa beans were being grown. To be honest, when I started this analysis, I had no idea where this process occurs. I assumed South America? To address my ignorance, I decide to produce a map that would tell me which countries grew beans and which did not. 

```{r, echo = F, include = F, warning = F}
# load data
choc_df <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-18/chocolate.csv')

# world dataset for plotting in ggplot
world_df <- rnaturalearth::ne_countries(scale = "medium",
                                        returnclass = "sf")

# mutate country names from chocolate dataset to match that of rnatural earth df
# remove county "Blend" as I can not figure out which country this is referring to
countries_fixed = choc_df %>% 
  mutate(updated_countries = recode(choc_df$country_of_bean_origin,
                                    "Burma" = "Myanmar",
                                    "Congo" = "Democratic Republic of the Congo",
                                    "DR Congo" = "Democratic Republic of the Congo", 
                                    "Martinique" = "Central African Republic" ,
                                    "Principe" = "Central African Republic",
                                    "Sao Tome" = "Central African Republic",
                                    "Sao Tome & Principe" = "Central African Republic" ,
                                    "St. Lucia"   = "Saint Lucia",
                                    "St.Vincent-Grenadines"  ="Saint Vincent and the Grenadines",
                                    "Sulawesi" = "Indonesia",
                                    "Sumatra"  ="Indonesia",
                                    "Tanzania" ="United Republic of Tanzania",
                                    "Tobago"  = "Trinidad and Tobago" ,
                                    "Trinidad"   = "Trinidad and Tobago" ,
                                    "U.S.A." = "United States of America")) %>% 
  filter(updated_countries != "Blend") 

# give a value of 1 to all countries that produce cocoa beens
world_choc <- world_df %>% 
  mutate(produces_choc = ifelse(admin %in% countries_fixed$updated_countries, "Produces",
                                "Does not produce"))

country_n <- countries_fixed %>% 
  group_by(updated_countries) %>% 
  summarise(number_comps = n())

country_n %>% 
  arrange(desc(number_comps))
```

```{r, echo = F}
ggplot() +
  geom_sf(data = world_choc, aes(fill = produces_choc)) +
  scale_fill_manual(name = "Produces cocoa beans",
                    values = c("white", "red")) + 
  theme(panel.background = element_rect(fill = "aliceblue"))
```

Well, my suspicion was partially correct! We see that beans are grown and sourced in from the Northern part of South America. It also seems as if Asia, Australia, Central Africa, and the Southern part of North America may be a hot spot as well. In fact, hot spot might be the best phrase to describe bean growth. It appears that all cocoa beans are sourced in from warm areas, around the equator. A quick group_by() call tells me that the top 5 cocoa been producing countries are Venezuela (253 companies sourcing their beans), Peru (244 companies), Dominican Republic (226 companies), Ecuador (219 companies), and Madagascar (177 companies).		

This plot leaves me with two thoughts. First, I am suprised to see the U.S. colored red. I've never heard of cocoa bean growth here. A quick google search tells me that beans grow in Hawaii, California and in Puerto Rico. Makes sense, if we stick with the hot theme. 

Secondly, what makes beans grown in Central Africa, but not Northern Africa? I'm assuming it's because there is not enough precipitaion in these countries. Similarly, this theory may be applied to the Middle Easter countries, where it's hot and dry. I guess plants do need water to grow, right? 



